$(function(){
    if (Modernizr.svg && swiffy) {
        // Define Swiffy SVG animations
        var startSign = {"tags":[{"type":9,"actions":[{"constants":["onEnterFrame","Active","true"],"type":136},{"index":0,"type":304},{"body":[{"index":2,"type":303},{"index":1,"type":304},{"type":78},{"index":2,"type":304},{"type":73},{"type":18},{"type":18},{"target":10,"type":157},{"type":7},{"target":15,"type":153},{"index":1,"type":303},{"index":0,"type":304},{"type":58},{"type":23},{"type":6}],"preloads":["this","_root"],"args":[],"type":142,"suppress":3,"registerCount":3},{"type":29},{"type":7}]},{"bounds":[{"ymin":724,"ymax":829,"xmin":953,"xmax":1033},{"ymin":724,"ymax":1729,"xmin":953,"xmax":1033}],"id":1,"fillstyles":[{"color":[-13421569],"type":1}],"paths":[{"fill":0,"data":[":53i24ga0h:a:5ja0H:a:5Jc",":53i24ga0h:a:05ja0H:a:05Jc"]}],"type":1},{"clip":4,"id":1,"matrix":0,"type":3,"depth":1},{"bounds":[{"ymin":0,"ymax":80,"xmin":0,"xmax":1085}],"id":2,"fillstyles":[{"color":[-20828],"type":1}],"paths":[{"fill":0,"data":[":::a:0ha85j:a:0Hc"]}],"flat":true,"type":1},{"tags":[{"id":2,"matrix":0,"type":3,"depth":1},{"type":2}],"id":3,"frameCount":1,"type":7},{"id":3,"matrix":"5536F6682D5536f5536F49i39p","type":3,"depth":2},{"bounds":[{"ymin":157,"ymax":623,"xmin":498,"xmax":1380}],"id":4,"fillstyles":[{"color":[-16711423],"type":1}],"paths":[{"fill":0,"data":[":24i2tbn:ykbjjjza:9la2G:a:9Lb:PkZbjKzKc:5u:bo:ykbkjkza:3ib:nKybJkYka5C:a:6Pc:25E5DbQ:1CgaZqaRzbFnF1ca:6caalaajadhahna0j8qabeaafa:6cb:oKybJkYkbO:YKbKJKYa:XaCHaHDaV:bF:IdaCha:xb:pf1caryazra1cfa1cFayRarYaf1Ca:6Ca:LaAHaDJaHNa1J7QaBDa:Ha:6Cb:OkYbjKyKbo:ykbkjkya:xb:kkkav:bk:kKa:XaF1CaRZaYQbNG1CGc:5k:aIdbCdCha:vb:klka1c:a:10db:kkkaw:bk:kKa:10Da1c:bl:lKa:VaDHaHDc:3laa2CfbOgZraQzbGnG1ca:73cadhagcaw:bk:kKa:0Ta2g:a:0tb:kkkaw:bk:kKa:73CaF1CaRZaYRa1CFc:7oAbJ:PgbFgFpa:32db:kkkaw:agCadHa:0Ta5c:bo:ykbkjkza:3pb:kkkav:bl:lKa:3Pb:6CY9EbyWy8Ea:3IaF2CaRZaYQbOG2CGc:2l:bF:IdaCha:vb:klka1c:a:10db:kkkaw:bk:kKa:10Da1c:bl:lKa:VaDHaHDc"]}],"flat":true,"type":1},{"tags":[{"id":4,"matrix":0,"type":3,"depth":1},{"id":3,"matrix":"4405c:9084C:8d96f","type":3,"depth":2},{"id":3,"matrix":"1090E292W7664c37U11p97f","type":3,"depth":4},{"id":3,"matrix":"1090E292W7664c37U8d97f","type":3,"depth":6},{"id":3,"matrix":"4405c:9084C1072M8d0h","type":3,"depth":8},{"id":3,"matrix":"1090E292w7664c8935L11p9g","type":3,"depth":10},{"id":3,"matrix":"1090E292w7664c8935L8d9g","type":3,"depth":12},{"type":2}],"id":5,"frameCount":1,"type":7},{"id":5,"matrix":"::::4e7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":11374,"type":3,"depth":1},{"replace":true,"matrix":"::::7h7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":21665,"type":3,"depth":1},{"replace":true,"matrix":"::::0k7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":30872,"type":3,"depth":1},{"replace":true,"matrix":"::::4l7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":38996,"type":3,"depth":1},{"replace":true,"matrix":"::::9l7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":46038,"type":3,"depth":1},{"replace":true,"matrix":"::::7h7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":51996,"type":3,"depth":1},{"replace":true,"matrix":"::::2f7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":56870,"type":3,"depth":1},{"replace":true,"matrix":"::::4e7m","type":3,"depth":11},{"type":2},{"replace":true,"ratio":60662,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":63369,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":64994,"type":3,"depth":1},{"bounds":[{"ymin":0,"ymax":260,"xmin":0,"xmax":260}],"id":6,"fillstyles":[{"color":[-20828],"type":1}],"paths":[{"fill":0,"data":[":0m:b4E:2I8cb8C8c8C2ib:4e8c2ib8c8c2i8cb4e:2i8Cb8c8C8c2Ib:4E8C2Ib8C8C2I8Cc"]}],"flat":true,"type":1},{"tags":[{"id":6,"matrix":0,"type":3,"depth":1},{"type":2}],"id":7,"frameCount":1,"type":7},{"id":7,"ratio":10,"matrix":"::::59h69n","type":3,"depth":9},{"type":2},{"type":4,"depth":1},{"type":4,"depth":2},{"bounds":[{"ymin":1561,"ymax":1641,"xmin":841,"xmax":946},{"ymin":1561,"ymax":1641,"xmin":841,"xmax":6071}],"id":8,"fillstyles":[{"color":[-13421569],"type":1}],"paths":[{"fill":0,"data":[":41h61oa5j:a:0ha5J:a:0Hc",":41h61oa230e:a:0ha230E:a:0Hc"]}],"type":1},{"clip":4,"id":8,"matrix":0,"type":3,"depth":1},{"id":3,"ratio":11,"matrix":"7907w:::99i59o","type":3,"depth":2},{"bounds":[{"ymin":1561,"ymax":1641,"xmin":841,"xmax":6071}],"id":9,"fillstyles":[{"color":[-13421569],"type":1}],"paths":[{"fill":0,"data":[":41h61oa:0ha230e:a:0Hc"]}],"flat":true,"type":1},{"clip":8,"id":9,"matrix":"4534F::57760g40i886R","type":3,"depth":5},{"id":3,"ratio":11,"matrix":"5536F6682D5536f5536F49i39p","type":3,"depth":6},{"type":2},{"replace":true,"ratio":6093,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":11889,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":17387,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":22588,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":27493,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":32100,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":36408,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":40421,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":44137,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":47555,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":50675,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":53499,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":56025,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":58254,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":60186,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":61821,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":63158,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":64199,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":64941,"type":3,"depth":1},{"type":2},{"replace":true,"ratio":65387,"type":3,"depth":1},{"type":2},{"type":4,"depth":1},{"type":4,"depth":2},{"type":9,"actions":[{"type":7}]},{"clip":4,"id":9,"matrix":0,"type":3,"depth":1},{"id":3,"ratio":32,"matrix":"7907w:::99i59o","type":3,"depth":2},{"type":2}],"fileSize":1662,"v":"4.9.0","frameSize":{"ymin":0,"ymax":1800,"xmin":0,"xmax":6000},"frameCount":33,"frameRate":25,"code":"","version":10};

        // Initialize Swiffy SVG animations
        /*var coffeeAnimation = new swiffy.Stage(document.getElementById('coffee-animation'), coffee);
        coffeeAnimation.start();
        var tableOfContentsAnimation = new swiffy.Stage(document.getElementById('table-of-contents-animation'), tableOfContents);
        tableOfContentsAnimation.start();*/
        var startSignAnimation = new swiffy.Stage(document.getElementById('start-animation'), startSign);
        startSignAnimation.start();

        // Trigger SVG animations once in view
        $('#start-tag').one('inview', function(event, isInView, visiblePartX, visiblePartY) {
            var elem = $(this);
            if (elem.data('inviewtimer')) {
                clearTimeout(elem.data('inviewtimer'));
                elem.removeData('inviewtimer');
            }
            if (isInView) {
                elem.data('inviewtimer', setTimeout(function() {
                    elem.unbind('inview');
                    startSignAnimation.setFlashVars('Active=true');
                }, 1000));
            }
        });

       /* $('#table-of-contents-animation').one('inview', function(event, isInView, visiblePartX, visiblePartY) {
            var elem = $(this);
            if (elem.data('inviewtimer')) {
                clearTimeout(elem.data('inviewtimer'));
                elem.removeData('inviewtimer');
            }
            if (isInView) {
                elem.data('inviewtimer', setTimeout(function() {
                    elem.unbind('inview');
                    tableOfContentsAnimation.setFlashVars('Active=true');
                }, 100));
            }
        });*/

        // Scale Swiffy SVG animations
        $("body").fitSwiffy();
    }
    // Transfer footer
    $("article").next("footer").appendTo("ol.curtains li:last");

    // Initialize curtains
    $('.curtains').curtain({scrollSpeed: 300});

});
